!function(a){var b,c,d={};a.fn.EasyGallery=function(a){b=this.find("a"),a&&(d=a),b.click(d.imageClick?d.imageClick:imageClick)},imageClick=function(b){b.preventDefault(),c&&c.removeClass("current"),drawOverlay(a(b.currentTarget)),drawWrapper(a(b.currentTarget))},drawWrapper=function(e){c=e;var f=a("<div></div>").addClass("eg-wrapper"),g=a("<div></div>").addClass("eg-footer"),h=a("<div></div>").addClass("eg-arrows");if(d.imageClickExt?loadCurrentImage(d.imageClickExt):loadCurrentImage(),b.length>1){var i=a("<div></div>").addClass("eg-back").addClass("eg-icon"),j=a("<div></div>").addClass("eg-forward").addClass("eg-icon");h.append(i),h.append(j),j.click(d.nextClick?nextImage:nextImage),i.click(d.previousClick?previousClickImage:previousImage)}if(d.footer)for(var k=d.footer.length,l={"class":"",title:"",click:function(){}},m=0;k>m;m++){var n=a("<div></div>").addClass("eg-icon"),o=a.extend({},l,d.footer[m]);n.css("background-image","url("+o.icon+")"),n.addClass(o.class),n.attr("title",o.title),d.footer[m].class&&n.addClass(d.footer[m].class),g.append(n),n.click(o.click)}var p=a("<div></div>").addClass("eg-close");f.append(p),f.append(g),f.append(h),a("body").append(f),a(".eg-wrapper").click(function(a){a.stopPropagation()}),p.click(d.closeClick?d.closeClick:function(){c&&c.removeClass("current"),a(".eg-wrapper").remove(),a(".eg-overlay").remove(),d.closeClickExt&&d.closeClickExt()})},nextImage=function(){index=b.index(c),index++,index>=b.length&&(index=0),c&&c.removeClass("current"),c=a(b[index]),d.nextClickExt?loadCurrentImage(d.nextClickExt()):loadCurrentImage()},loadCurrentImage=function(b){c.addClass("current");var d=a("<img />").attr("src",c.attr("href")).load(function(){if(this.complete&&"undefined"!=typeof this.naturalWidth&&0!==this.naturalWidth){attrs=c.data();for(var e in attrs)d.attr("data-"+e,attrs[e]);a(".eg-wrapper img").remove(),a(".eg-wrapper").css("width",this.width),a(".eg-wrapper").css("height",this.height),a(".eg-wrapper").append(d),b&&b()}else alert("broken image!")})},previousImage=function(){index=b.index(c),index--,c&&c.removeClass("current"),0>index&&(index=b.length-1),c=a(b[index]),d.previousClickExt?loadCurrentImage(d.previousClickExt):loadCurrentImage()},drawOverlay=function(){var b=a("<div></div>").addClass("eg-overlay");a("body").append(b),a(".eg-overlay").click(function(){c&&c.removeClass("current"),a(".eg-wrapper").remove(),a(".eg-overlay").remove()})}}(jQuery);