!function(a){var b,c,d={};a.fn.EasyGallery=function(a){b=this.find("a"),a&&(d=a),b.click(d.imageClick?d.imageClick:imageClick)},imageClick=function(b){b.preventDefault(),drawOverlay(a(b.currentTarget)),drawWrapper(a(b.currentTarget)),d.imageClickExt&&d.imageClickExt(b)},drawWrapper=function(e){c=e;var f=a("<div></div>").addClass("eg-wrapper"),g=a("<div></div>").addClass("eg-footer"),h=a("<div></div>").addClass("eg-arrows");if(loadCurrentImage(),b.length>1){var i=a("<div></div>").addClass("eg-back").addClass("eg-icon"),j=a("<div></div>").addClass("eg-forward").addClass("eg-icon");h.append(i),h.append(j),j.click(d.nextClick?nextImage:nextImage),i.click(d.previousClick?previousClickImage:previousImage)}if(d.footer)for(var k=d.footer.length,l=0;k>l;l++){var m=a("<div></div>").addClass("eg-icon");m.css("background-image","url("+d.footer[l].icon+")"),g.append(m),m.click(d.footer[l].click)}var n=a("<div></div>").addClass("eg-close");f.append(n),f.append(g),f.append(h),a("body").append(f),a(".eg-wrapper").click(function(a){a.stopPropagation()}),n.click(d.closeClick?d.closeClick:function(b){a(".eg-wrapper").remove(),a(".eg-overlay").remove(),d.closeClickExt&&d.closeClickExt(b)})},nextImage=function(e){index=b.index(c),index++,index>=b.length&&(index=0),c=a(b[index]),loadCurrentImage(),d.nextClickExt&&d.nextClickExt(e)},loadCurrentImage=function(){var b=a("<img />").attr("src",c.attr("href")).load(function(){if(this.complete&&"undefined"!=typeof this.naturalWidth&&0!==this.naturalWidth){attrs=c.data();for(var d in attrs)b.attr("data-"+d,attrs[d]);a(".eg-wrapper img").remove(),a(".eg-wrapper").css("width",this.width),a(".eg-wrapper").append(b)}else alert("broken image!")})},previousImage=function(e){index=b.index(c),index--,0>index&&(index=b.length-1),c=a(b[index]),loadCurrentImage(),d.previousClickExt&&d.previousClickExt(e)},drawOverlay=function(){var b=a("<div></div>").addClass("eg-overlay");a("body").append(b),a(".eg-overlay").click(function(){a(".eg-wrapper").remove(),a(".eg-overlay").remove()})}}(jQuery);